import{get as t,keyBy as r,values as n,merge as e,flatten as a,uniq as u}from"lodash";import i from"@babel/runtime/helpers/slicedToArray";import c from"@babel/runtime/regenerator";import o from"@babel/runtime/helpers/asyncToGenerator";import s from"@babel/runtime/helpers/toConsumableArray";import{ASSET_TYPES as d}from"../../../../constants/assetTypes.js";import{getAppsDataByRigs as p,fetchRigs as f,getAppsDataByWells as l,fetchWells as m,fetchAssetEntitiesByAssetIds as b,getAppsDataByFFs as y,getUniqAssetIds as x,fetchFracFleets as h,fetchFracFleetWells as v}from"./utils.js";function k(t,r){return w.apply(this,arguments)}function w(){return(w=o(c.mark((function e(a,u){var i,o,s,y,x,h,v,k,w,g;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b([a]);case 2:if(i=e.sent,o=t(n(i),"[0][0].data")){e.next=6;break}return e.abrupt("return",{});case 6:if(o.type!==d.well.type){e.next=16;break}return e.next=9,m([o.id]);case 9:if(s=e.sent){e.next=12;break}return e.abrupt("return",{});case 12:return y=t(s,"data"),x=y&&r(y.concat(s.included),"id"),h=l(u,x,(function(r){return r[t(s,"data[0].id")]})),e.abrupt("return",h);case 16:if(o.type!==d.rig.type){e.next=24;break}if(v=f([o.id])){e.next=20;break}return e.abrupt("return",{});case 20:return k=t(v,"data"),w=k&&r(k.concat(v.included),"id"),g=p(u,w,(function(r){return r[t(v,"data[0].id")]})),e.abrupt("return",g);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(t,r,n,e){return T.apply(this,arguments)}function T(){return(T=o(c.mark((function t(n,a,u,o){var d,b,k,w,g,T,j,A,P,C,G,S,_,q,z,B;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d=x(n),b=x(a),k=x(u),w=s(new Set(u)),t.next=6,Promise.all([m(d),f(b),h(k),v(w,o)]);case 6:if(g=t.sent,T=i(g,4),j=T[0],A=T[1],P=T[2],C=T[3],j||A||P||C){t.next=14;break}return t.abrupt("return",{});case 14:return G=(null==j?void 0:j.data)&&r(j.data.concat(j.included),"id"),S=(null==A?void 0:A.data)&&r(A.data.concat(A.included),"id"),_=(null==P?void 0:P.data)&&r(P.data.concat(P.included),"id"),q=l(n,G,(function(t,r){return t[r]})),z=p(a,S,(function(t,r){return t[r]})),B=y(u,_,C),t.abrupt("return",e(q,z,B));case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function j(t,r,n){return A.apply(this,arguments)}function A(){return(A=o(c.mark((function o(s,y,h){var v,k,w,g,T,j,A,P,C,G,S,_,q,z,B,D;return c.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return v=x(s),c.next=3,b(v);case 3:return k=c.sent,w=a(n(k)),g=u(w.filter((function(r){return t(r,"data.type")===d.well.type})).map((function(r){return+t(r,"data.id")})).concat(y.map((function(t){var r=i(t,2);r[0];return r[1]})))),T=u(w.filter((function(r){return t(r,"data.type")===d.rig.type})).map((function(r){return+t(r,"data.id")})).concat(h.map((function(t){var r=i(t,2);r[0];return r[1]})))),c.next=9,Promise.all([m(g),f(T)]);case 9:if(j=c.sent,A=i(j,2),P=A[0],C=A[1],P||C){c.next=15;break}return c.abrupt("return",{});case 15:return G=t(P,"data"),S=t(C,"data"),_=G&&r(G.concat(P.included),"id"),q=S&&r(S.concat(C.included),"id"),z=s.map((function(r){var n=i(r,2),e=n[0],a=n[1];return[e,G.concat(S).find((function(r){return t(r,"attributes.asset_id")===a})).id]})).concat(y,h),B=l(z,_,(function(t,r){return t[r]})),D=p(z,q,(function(t,r){return t[r]})),c.abrupt("return",e(B,D));case 23:case"end":return c.stop()}}),o)})))).apply(this,arguments)}export{k as resolveAppsDataForAssetDashboard,j as resolveAppsDataForFeedPage,g as resolveAppsDataForGeneralDashboard};

import e from"@babel/runtime/helpers/defineProperty";import{mapValues as r}from"lodash";import t from"@babel/runtime/helpers/slicedToArray";import n from"@babel/runtime/regenerator";import i from"@babel/runtime/helpers/asyncToGenerator";import{ASSET_TYPES as o}from"../../../../constants/assetTypes.js";import{useState as a,useEffect as s}from"react";import{isDevCenterApp as u,appFieldGetter as c,getAppAssetSpecificTypeId as p}from"./utils.js";import{resolveAppsDataForFeedPage as f,resolveAppsDataForAssetDashboard as l,resolveAppsDataForGeneralDashboard as d}from"./dataResolvers.js";function m(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function b(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){e(r,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var g=function(e){return[p(e,o.well.id),p(e,o.rig.id),p(e,o.frac_fleet.id),p(e,"deprecatedAssetId")].join("-")},h={id:null,rig:null,well:null,fracFleet:null,wells:null,isLoading:!1,appHash:null};function O(m){var O=m.apps,j=m.dashboardAssetId,y=O.filter(u),v=a((function(){return function(r){return r.reduce((function(r,t){var n=c(t,["id"]);return b(b({},r),{},e({},n,b(b({},h),{},{id:n,isLoading:!0,appHash:g(t)})))}),{})}(y)})),w=t(v,2),P=w[0],x=w[1],S=[],k=[],A=[],D=[],H=[];y.forEach((function(e){if(!c(e,["app","ui_settings","multi_rig"])){var r=p(e,o.well.id),t=p(e,o.rig.id),n=p(e,o.frac_fleet.id),i=p(e,"deprecatedAssetId"),a=c(e,["id"]);D.push([a]),j||(r?S.push([a,r]):t?k.push([a,t]):i?H.push([a,i]):n&&A.push([a,n]))}}));var L=!!j,_=!j&&!H.length,E=!j&&H.length,I=function(r){return y.reduce((function(t,n){var i=c(n,["id"]),o=r[i],a=g(n);return o&&a===o.appHash?b(b({},t),{},e({},i,o)):b(b({},t),{},e({},i,b(b({},h),{},{id:i,isLoading:!0,appHash:a})))}),{})};return s(i(n.mark((function e(){var t;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},x(I),!_){e.next=6;break}return e.next=5,d(S,k,A,y);case 5:t=e.sent;case 6:if(!L){e.next=10;break}return e.next=9,l(j,D);case 9:t=e.sent;case 10:if(!E){e.next=14;break}return e.next=13,f(H,S,k);case 13:t=e.sent;case 14:x((function(e){return r(e,(function(e){var r=t[e.id]||{};return b(b(b({},e),r),{},{isLoading:!1})}))}));case 15:case"end":return e.stop()}}),e)}))),[String(S),String(k),String(A),String(D),j]),P}export default O;

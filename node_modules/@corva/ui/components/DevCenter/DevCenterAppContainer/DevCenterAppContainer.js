import t from"@babel/runtime/helpers/defineProperty";import{get as n,pickBy as e,pick as o}from"lodash";import s from"@babel/runtime/helpers/slicedToArray";import"@babel/runtime/regenerator";import"@babel/runtime/helpers/asyncToGenerator";import"../../../constants/goals.js";import"../../../constants/apps.js";import"../../../constants/completion.js";import{SEGMENTS as i}from"../../../constants/segment.js";import{displayIntercomIcon as r}from"../../../utils/intercom.js";import"../../../constants/alerts.js";import{isNativeDetected as p,isMobileDetected as a}from"../../../utils/mobileDetect.js";import{jsxs as m,jsx as c,Fragment as l}from"react/jsx-runtime";import{useContext as g,useState as u}from"react";import"querystring";import"uuid/v1";import"../../../clients/jsonApi/index.js";import"../../../clients/subscriptions.js";import A from"../../../effects/useDevCenterApp.js";import d from"classnames";import{AnnotationsProvider as f}from"../../Annotations/AnnotationsContext.js";import j from"../../Annotations/components/AnnotationsList/index.js";import"../../Annotations/components/LastAnnotation/index.js";import{DEV_CENTER_CLI_APP_ID as y}from"../../../constants/devcenter.js";import"../../../constants/drillstring.js";import C from"./effects/useAppSettings.js";import b from"./effects/useAnnotationsList.js";import h from"./effects/useAnnotationsData.js";import S from"./components/AppActions/AppActions.js";import D from"./components/AppSettingsDialog/AppSettingsDialog.js";import v from"./components/AnnotationsButton/AnnotationsButton.js";import{getAppVersion as L,isAppMaximized as I,getTimestampFromQuery as O}from"./utils.js";import P from"./components/NonPriorityMenus/NonPriorityMenus.js";import w from"./components/FullscreenButton/FullscreenButton.js";import"./components/AppInfoMessage/AppInfoMessage.js";import M from"./components/DevCenterAppView/DevCenterAppView.js";import x from"../AppContext.js";import N from"./DevCenterAppContainer.css.js";import B from"./components/RestoreAppSizeButton/index.js";import E from"./components/PriorityMenus/PriorityMenus.js";function R(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function U(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?R(Object(o),!0).forEach((function(e){t(n,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):R(Object(o)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(o,t))}))}return n}var q=p||a;function k(t){var a,R=t.CLIAppComponent,k=t.CLIAppSettings,F=t.app,_=t.appId,z=t.coordinates,T=t.currentDashboardAppsLastAnnotations,G=t.currentUser,V=t.isActionsDisabled,H=t.layoutEnvironment,K=t.location,J=t.onAppRemove,Q=t.onSettingChange,W=t.onSettingsChange,X=t.showSuccessNotification,Y=t.updateCurrentDashboardAppLastAnnotation,Z=g(x),$=u([]),tt=s($,2),nt=tt[0],et=tt[1],ot=u([]),st=s(ot,2),it=st[0],rt=st[1],pt=Z&&Z[_||F.id]||{isLoading:!0},at=F.package.manifest.application,mt=n(at,"segments.0",i.DRILLING),ct=!(null==at||null===(a=at.ui)||void 0===a||!a.multi_rig),lt=F.id===y&&q?U(U({},z),{},{w:12}):z,gt=A({CLIAppComponent:R,CLIAppSettings:k,url:F.package.url,appKey:F.app.app_key,version:L(F)}),ut=gt.isLoading,At=gt.AppSettings,dt=gt.AppComponent,ft=C(),jt=ft.isAppSettingsDialogOpened,yt=ft.toggleAppSettingsDialog,Ct=b(),bt=Ct.isAnnotationsListOpened,ht=Ct.toggleAnnotationsList,St=ut||!G||!ct&&pt.isLoading,Dt=K.pathname,vt=K.query,Lt=I(vt,F.id),It=O(null==vt?void 0:vt.query),Ot=h({app:F,appData:pt,currentDashboardAppsLastAnnotations:T}),Pt=Ot.appLastAnnotation,wt=Ot.assetCompanyId,Mt=Ot.assetIdForAnnotation,xt=Ot.isAppSupportsAnnotations;Lt&&r(!1);var Nt=e(o(pt,["well","rig","fracFleet","wells"]),Boolean);return m("div",{"data-testid":"".concat("DevCenter_AppContainer","_").concat(F.app.name),className:d("dc-app-container",N.container,Lt&&N.containerMaximized),children:[c("div",{className:N.containerContent,children:c(M,{AppComponent:dt,app:F,appData:Nt,isLoading:St,isMultiRig:ct,appProps:{coordinates:lt,currentUser:G,setMainMenuItems:et,setSecondaryMenuItems:rt,onSettingsChange:W,onSettingChange:Q,appHeaderProps:U({appLastAnnotation:Pt,updateCurrentDashboardAppLastAnnotation:Y,toggleAnnotationsList:ht,onSettingChange:Q,app:F,currentUser:G,appSettings:F.settings,layoutEnvironment:H,coordinates:lt},Nt),isNative:p,layoutEnvironment:H,timestamp:It}})}),jt&&c(D,{AppSettingsComponent:At,app:F,appData:pt,currentUser:G,isMultiRig:ct,layoutEnvironment:H,onAppRemove:J,onSettingChange:Q,onSettingsChange:W,segment:mt,timestamp:It,toggleAppSettingsDialog:yt}),bt&&c(f,{children:c(j,{appId:F.app.id,appSettings:F.settings,appTitle:F.name,assetCompanyId:wt,assetId:Mt,currentUser:G,onClose:ht,showSuccessNotification:X})}),!V&&Lt&&c(B,{currentUser:G,location:K}),m(S,{toggleAppSettingsDialog:yt,children:[xt&&Mt&&c(v,{toggleAnnotationsList:ht}),q&&!Lt?c(w,{pathname:Dt,query:vt,appId:F.id}):m(l,{children:[c(E,{menuItems:nt}),c(P,{toggleAppSettingsDialog:yt,appId:F.id,pathname:Dt,query:vt,menuItems:it,isMaximized:Lt})]})]})]})}export default k;

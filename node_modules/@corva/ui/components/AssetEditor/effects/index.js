import e from"@babel/runtime/helpers/defineProperty";import"lodash/set";import"lodash/get";import"moment";import t from"@babel/runtime/helpers/slicedToArray";import r from"@babel/runtime/regenerator";import n from"@babel/runtime/helpers/asyncToGenerator";import"@babel/runtime/helpers/toConsumableArray";import{useState as o,useEffect as a,useRef as s}from"react";import"lodash/unset";import"../../../clients/api/apiCore.js";import"../../../clients/constants.js";import{mapAssetGetRequest as c}from"../../../clients/jsonApi/index.js";import"../../../clients/subscriptions.js";import{PER_PAGE as i}from"../constants.js";function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?p(Object(n),!0).forEach((function(r){e(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f=function(e){return{sort:"name",order:"asc",fields:["".concat(e,".name"),"".concat(e,".asset_id")]}},l=function(e){return u(u({},e.attributes),{},{id:+e.id})};function m(s,i,p,m){var b=o([]),y=t(b,2),d=y[0],h=y[1],O=o(!0),j=t(O,2),g=j[0],v=j[1];return a((function(){function t(){return(t=n(r.mark((function t(){var n;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c(s)(u(u({},f(s)),{},e({per_page:1e4},p,m)));case 2:n=t.sent,h(n.data.map(l)),v(!1);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}v(!0),function(){t.apply(this,arguments)}()}),[s,i,p,m]),{assets:d,loading:g}}function b(e){var p=e.assetType,m=e.currentValue,b=e.parentAssetType,y=e.parentAssetId,d=e.scrollPage,h=e.companyId,O=e.searchText,j=e.setCurrentOption,g=o([]),v=t(g,2),w=v[0],x=v[1],P=o(!1),k=t(P,2),A=k[0],T=k[1],D=s();return a((function(){function e(){return(e=n(r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(p)(u(u({},f(p)),{},{ids:[m]}));case 2:t=e.sent,n=t.data[0],j(n?l(n):null);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}m&&function(){e.apply(this,arguments)}()}),[]),a((function(){function e(){return(e=n(r.mark((function e(){var t,n,o,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,T(!0),t={per_page:i,page:d},b&&y&&(t[b]=y),h&&(t.company=h),O&&(t.search=O),e.next=8,c(p)(u(u({},f(p)),t));case 8:n=e.sent,o=n.data.map(l),a=D.current!==p||1===d,x(a?o:function(e){return e.concat(o)}),D.current=p,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:T(!1);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[p,b,y,h,O,d]),{assets:w,loading:A}}export{b as useAssetAutoCompleteSelectData,m as useAssetSelectData};
